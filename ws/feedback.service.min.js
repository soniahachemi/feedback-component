angular.module("feedback.createFeedback").service("wsFeedback",function(e,r,t,n){"use strict";function a(e){var r=e.data;return 200!==r.status?o(e):r.hasOwnProperty("data")&&r.data||r}function o(r){if(-1===r.status)return e.reject();var t=r.data&&r.data.error||"Unknown error";return r.hasOwnProperty("status")&&r.status>0&&n.error(t),e.reject(t)}function s(e){return~e.url.indexOf(i)||(e.url=i+e.url),t(e).then(a,o)}var u=this,i="/datacenter/tools/feedback/ws/";angular.forEach(["get","post"],function(e){u[e]=function(r,t){return s(angular.extend(t,{url:r,method:e}))}})}).service("wsSubmitFeedback",function(e,r,t,n){function a(r){return u.hasOwnProperty(r)&&angular.isFunction(u[r].resolve())&&(u[r].resolve(),delete u[r]),u[r]=e.defer(),u[r].promise}function o(e){return e.data.objectType=s,e.noTimeout||e.timeout||(e.timeout=a(e.data.action)),delete e.noTimeout,n.post("ws.cgi",e)}var s="feedback",u={};this.submitFeedback=function(e){return o({data:{action:"submitFeedback",url:e.url,message:e.message,screenshot:e.screenshot,browser:r.browser,device:r.device,os:r.os,os_version:r.os_version,browser_version:r.browser_version,app_name:e.app_name,app_version:e.app_version,type:e.type}})}});
